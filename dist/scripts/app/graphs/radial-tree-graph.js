define(["jquery","underscore","app/utils/math-ext"],function(a,b,c){"use strict";function d(){this._radiusX=0,this._radiusY=0,this._rootX=0,this._rootY=0,this._width=0,this._height=0}return Object.defineProperties(d.prototype,{radiusX:{get:function(){return this._radiusX},set:function(a){this._radiusX=a},enumerable:!0},radiusY:{get:function(){return this._radiusY},set:function(a){this._radiusY=a},enumerable:!0},rootX:{get:function(){return this._rootX},set:function(a){this._rootX=a},enumerable:!0},rootY:{get:function(){return this._rootY},set:function(a){this._rootY=a},enumerable:!0},width:{get:function(){return this._width},set:function(a){this._width=a},enumerable:!0},height:{get:function(){return this._height},set:function(a){this._height=a},enumerable:!0}}),d.prototype.run=function(a,b,c){var d=a.depth,e=this.width;this.width===this.rootX&&this.rootX===this.radiusX&&0===this.rootX&&(e=b),0!==e&&(this.rootX=e/2,this.radiusX=this.rootX/d);var f=this.height;this.height===this.rootY&&this.rootY===this.radiusY&&0===this.rootY&&(f=c),0!==f&&(this.rootY=f/2,this.radiusY=this.rootY/d),this.layoutTree(a)},d.prototype.layoutTree=function(a){a.angle=0,a.x=this.rootX,a.y=this.rootY,a.rightBisector=0,a.rightTangent=0,a.leftBisector=c.TWO_PI,a.leftTangent=c.TWO_PI,this.layoutTreeN(1,[a])},d.prototype.layoutTreeN=function(a,d){var e=0,f=null,g=null,h=[];if(b.forEach(d,function(c){var d=c.children,i=c.rightLimit,j=(c.leftLimit-i)/d.length;b.forEach(d,function(b,c){if(b.angle=i+(c+.5)*j,b.x=this.rootX+a*this.radiusX*Math.cos(b.angle),b.y=this.rootY+a*this.radiusY*Math.sin(b.angle),b.hasChildren){h.push(b),null===f&&(f=b);var d=b.angle-e;b.rightBisector=b.angle-d/2,null!==g&&(g.leftBisector=b.rightBisector);var k=a/(a+1),l=2*Math.asin(k);b.leftTangent=b.angle+l,b.rightTangent=b.angle-l,e=b.angle,g=b}},this)},this),null!==f){var i=c.TWO_PI-g.angle;f.rightBisector=(f.angle-i)/2,g.leftBisector=f.rightBisector<0?f.rightBisector+c.TWO_PI+c.TWO_PI:f.rightBisector+c.TWO_PI}h.length>0&&this.layoutTreeN(a+1,h)},d});