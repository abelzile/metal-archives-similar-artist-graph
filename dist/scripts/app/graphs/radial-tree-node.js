define(["jquery","underscore"],function(a,b){"use strict";function c(a){this._data=a,this._children=[],this._angle=0,this._x=0,this._y=0,this._rightBisector=0,this._leftBisector=0,this._rightTangent=0,this._leftTangent=0,this._level=0,this._flatArrayCache=null,this._levelArrayCache=null}return Object.defineProperties(c.prototype,{data:{get:function(){return this._data},enumerable:!0},children:{get:function(){return this._children},enumerable:!0},angle:{get:function(){return this._angle},set:function(a){this._angle=a},enumerable:!0},x:{get:function(){return this._x},set:function(a){this._x=a},enumerable:!0},y:{get:function(){return this._y},set:function(a){this._y=a},enumerable:!0},rightBisector:{get:function(){return this._rightBisector},set:function(a){this._rightBisector=a},enumerable:!0},leftBisector:{get:function(){return this._leftBisector},set:function(a){this._leftBisector=a},enumerable:!0},rightTangent:{get:function(){return this._rightTangent},set:function(a){this._rightTangent=a},enumerable:!0},leftTangent:{get:function(){return this._leftTangent},set:function(a){this._leftTangent=a},enumerable:!0},depth:{get:function(){var a=1;return b.forEach(this._children,function(b){var c=b.depth;c>=a&&(a=c+1)},this),a},enumerable:!0},hasChildren:{get:function(){return null!==this._children&&this._children.length>0},enumerable:!0},leftLimit:{get:function(){return Math.min(this._leftBisector,this._leftTangent)},enumerable:!0},rightLimit:{get:function(){return Math.max(this._rightBisector,this._rightTangent)},enumerable:!0},level:{get:function(){return this._level},set:function(a){this._level=a},enumerable:!0}}),c.prototype.addChild=function(a){this._children.push(a),this._flatArrayCache=null,this._levelArrayCache=null},c.prototype.toFlatArray=function(){if(null!==this._flatArrayCache)return this._flatArrayCache;for(var a=[this],c=[this];c.length>0;){var d=c.pop();d.hasChildren&&b.forEach(d.children,function(b){a.push(b),c.push(b)},this)}return this._flatArrayCache=a},c.prototype.toLevelArray=function(){if(null!==this._levelArrayCache)return this._levelArrayCache;var a=[];return a[0]=[],a[0].push([this]),this._toLevelArrayN(this,a),this._levelArrayCache=a},c.prototype._toLevelArrayN=function(a,c){var d=a.children;if(a.hasChildren){var e=a.level;void 0===c[e]&&(c[e]=[]),c[e].push(b.map(d,function(a){return a})),b.forEach(d,function(a){this._toLevelArrayN(a,c)},this)}},c});