define(["underscore"],function(a){"use strict";function b(a){this._data=a,this._children=[],this._angle=0,this._x=0,this._y=0,this._rightBisector=0,this._leftBisector=0,this._rightTangent=0,this._leftTangent=0,this._level=0,this._flatArrayCache=null,this._levelArrayCache=null}return Object.defineProperties(b.prototype,{data:{get:function(){return this._data},enumerable:!0},children:{get:function(){return this._children},enumerable:!0},angle:{get:function(){return this._angle},set:function(a){this._angle=a},enumerable:!0},x:{get:function(){return this._x},set:function(a){this._x=a},enumerable:!0},y:{get:function(){return this._y},set:function(a){this._y=a},enumerable:!0},rightBisector:{get:function(){return this._rightBisector},set:function(a){this._rightBisector=a},enumerable:!0},leftBisector:{get:function(){return this._leftBisector},set:function(a){this._leftBisector=a},enumerable:!0},rightTangent:{get:function(){return this._rightTangent},set:function(a){this._rightTangent=a},enumerable:!0},leftTangent:{get:function(){return this._leftTangent},set:function(a){this._leftTangent=a},enumerable:!0},depth:{get:function(){var b=1;return a.forEach(this._children,function(a){var c=a.depth;c>=b&&(b=c+1)},this),b},enumerable:!0},hasChildren:{get:function(){return null!==this._children&&this._children.length>0},enumerable:!0},leftLimit:{get:function(){return Math.min(this._leftBisector,this._leftTangent)},enumerable:!0},rightLimit:{get:function(){return Math.max(this._rightBisector,this._rightTangent)},enumerable:!0},level:{get:function(){return this._level},set:function(a){this._level=a},enumerable:!0}}),a.extend(b.prototype,{addChild:function(a){this._children.push(a),this._flatArrayCache=null,this._levelArrayCache=null},toFlatArray:function(){if(null!==this._flatArrayCache)return this._flatArrayCache;for(var b=[this],c=[this],d=function(a){b.push(a),c.push(a)};c.length>0;){var e=c.pop();a.forEach(e.children,d,this)}return this._flatArrayCache=b},toLevelArray:function(){if(null!==this._levelArrayCache)return this._levelArrayCache;var a=[[[this]]];return this._toLevelArrayN(this,a),this._levelArrayCache=a},_toLevelArrayN:function(b,c){var d=b.children;if(b.hasChildren){var e=b.level;void 0===c[e]&&(c[e]=[]),c[e].push(a.map(d,function(a){return a})),a.forEach(d,function(a){this._toLevelArrayN(a,c)},this)}}}),b});