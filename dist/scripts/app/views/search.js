define(["jquery","underscore","backbone","app/models/band","app/collections/band-related-list","app/collections/band-search-query","app/views/search-result","lib/jqueryui-custom/jquery-ui.min","lib/jquery-dialogextend/jquery.dialogextend"],function(a,b,c,d,e,f,g){"use strict";return c.View.extend({el:"#search",initialize:function(){this.$searchInput=this.$el.find("#search-input"),this.$searchResults=this.$el.find("#search-results"),this.$tBody=this.$searchResults.find("#search-results-table").children("tbody"),this.$count=this.$el.find("#search-results-count"),this.$count.css({height:this.$searchInput.outerHeight()+"px","line-height":this.$searchInput.outerHeight()+"px"}),this.$el.dialog({autoOpen:!0,closeOnEscape:!1,draggable:!0,height:250,modal:!1,position:{my:"left top",at:"left top",of:window},resizable:!1,title:"Search",width:450}).dialogExtend({closable:!1,collapsable:!0}).show("fast"),this.listenTo(this.collection,"reset",this.render)},events:{"click #search-btn":"_searchBtn","keypress #search-input":"_searchKb"},render:function(){return this.$tBody.empty(),this.$count.text(this.collection.length+" band(s) found."),this.collection.each(this._renderOne,this),this.$searchResults.show(),this.trigger("search:searched"),this},_renderOne:function(a){var b=new g({model:a});return this.listenTo(b,"search-result:select",function(a){this.trigger("search:select",a)}),this.$tBody.append(b.render().$el),this},_searchBtn:function(){var a=this.$searchInput.val();this._isSearchValid(a)&&this._search(a)},_searchKb:function(a){if(13===a.which){var b=this.$searchInput.val();this._isSearchValid(b)&&this._search(b)}},_search:function(a){this.stopListening(null,"search-result:select"),this.trigger("search:searching"),this.collection.fetch({data:new f(a).build(),success:function(){},error:function(){}})},_isSearchValid:function(a){return!!a}})});